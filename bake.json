{
  "$schema": "./schema.json",
  "name": "bake",
  "version": "0.0.1-alpha",
  "description": "A less painful build tool",
  "variables": {
    "src": "./src",
    "out": "./out",
    "cc": "clang++",
    "ccflags": "-Wall -O3",
    "ldflags": "-llibcurl -libglaze",
    "dbg": "echo \"name: ${:name}\tversion: ${:version}\tsrc: '${src}'\tldflags: '${ldflags}'\tnope: '${nope}'\traw: '\\${raw}' [EOT]\""
  },
  "targets": {
    "debug": {
      "variables": {
        "ccflags": "${ccflags} -O1 -DDEBUG"
      },
      "cmd": ["cc ${ccflags}"]
    },
    "dbg": {
      "cmd": ["${dbg}"]
    },
    "clean": {
      "cmd": ["rm -rf ${out}/*"]
    },
    "install": {
      "cmd": [
        "cp ${out}/*.o /usr/local/lib/",
        "cp ${src}/*.h /usr/local/include/",
        "cp ${out}/bake /usr/local/bin/"
      ]
    },
    "${out}/**/*.o": {
      "in": ["${src}/**/*.c"],
      "transitive": ["${src}/**/*.h"],
      "cmd": ["echo ${:transitive}", "${cc} -c ${ccflags} -o ${:target} ${:in}"]
    },
    "${out}/bake": {
      "default": true,
      "in": ["${out}/*.o"],
      "cmd": ["${cc} ${ldflags} -o ${:target} ${:in}"]
    }
  }
}
